import{Eb as a,Lc as C,Nb as c,Ob as r,Pb as f,Vb as u,Vc as P,Wb as s,Yc as _,db as d,fb as n,fc as p,gc as h,hc as x,kb as m,qb as l,ub as g}from"./chunk-G5HKJUTV.js";function b(o,v){if(o&1&&(c(0,"div",4)(1,"p"),p(2,"Escaneie o QR Code com seu app banc\xE1rio:"),r(),f(3,"img",5),r()),o&2){let t=s();n(3),a("src","data:image/png;base64,"+t.qrCodeBase64,d)}}function y(o,v){if(o&1&&(c(0,"p",6),p(1),r()),o&2){let t=s();n(),h(t.erro)}}var k=(()=>{class o{constructor(t){this.http=t,this.qrCodeBase64=null,this.carregando=!1,this.erro=null}iniciarPagamento(){let t={descricao:"Produto de teste",preco:100,quantidade:1};this.http.post("http://localhost:3000/api/pagamento/criar-preferencia",t).subscribe({next:e=>{e?.id?window.location.href=`https://www.mercadopago.com.br/checkout/v1/redirect?preference_id=${e.id}`:console.error("Prefer\xEAncia sem ID")},error:e=>{console.error("Erro ao criar prefer\xEAncia",e)}})}pagarComPix(){this.carregando=!0,this.erro=null;let t={valor:100,descricao:"Produto de teste via Pix"};this.http.post("http://localhost:3000/api/pagamento/criar-pagamento-pix",t).subscribe({next:e=>{this.qrCodeBase64=e.qr_code_base64,this.carregando=!1},error:e=>{console.error("Erro ao criar pagamento Pix",e),this.erro="Erro ao gerar QR Code. Tente novamente.",this.carregando=!1}})}static{this.\u0275fac=function(e){return new(e||o)(m(C))}}static{this.\u0275cmp=l({type:o,selectors:[["app-payment"]],decls:7,vars:4,consts:[[1,"pagamento-container"],[3,"click","disabled"],["class","qrcode-container",4,"ngIf"],["class","erro",4,"ngIf"],[1,"qrcode-container"],["alt","QR Code Pix",3,"src"],[1,"erro"]],template:function(e,i){e&1&&(c(0,"div",0)(1,"h2"),p(2,"Pagamento via Pix"),r(),c(3,"button",1),u("click",function(){return i.pagarComPix()}),p(4),r(),g(5,b,4,1,"div",2)(6,y,2,1,"p",3),r()),e&2&&(n(3),a("disabled",i.carregando),n(),x(" ",i.carregando?"Gerando QR Code...":"Pagar com Pix"," "),n(),a("ngIf",i.qrCodeBase64),n(),a("ngIf",i.erro))},dependencies:[_,P],styles:[".pagamento-container[_ngcontent-%COMP%]{text-align:center;margin-top:2rem}button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;background-color:#03a9f4;color:#fff;border:none;border-radius:8px;cursor:pointer}.qrcode-container[_ngcontent-%COMP%]{margin-top:2rem}img[_ngcontent-%COMP%]{width:250px;height:250px}.erro[_ngcontent-%COMP%]{color:red;margin-top:1rem}"]})}}return o})();export{k as PaymentComponent};
